/* --- tighten rows & kill 100%-width defaults --- */
.sw5e-helper-attack .row,
.sw5e-helper-damage .row {
  display: flex !important;
  align-items: center;
  gap: 0.4rem;          /* slightly tighter than before */
  flex-wrap: wrap;
  margin: 0.25rem 0;
}

.sw5e-helper-attack .row select,
.sw5e-helper-attack .row input,
.sw5e-helper-attack .row button,
.sw5e-helper-damage .row select,
.sw5e-helper-damage .row input,
.sw5e-helper-damage .row button {
  width: auto !important;      /* override Foundry's 100% width */
  max-width: 100%;
  flex: 0 0 auto;
  height: 26px;                /* consistent control height */
  line-height: 24px;
  padding: 2px 6px;
}

/* labels shouldn't wrap */
.sw5e-helper-attack .row > label,
.sw5e-helper-damage .row > label,
.sw5e-helper-attack .row span,
.sw5e-helper-damage .row span {
  margin: 0;
  white-space: nowrap;
}

/* long text inputs: only where we want them to stretch */
.sw5e-helper-attack .uni2 input[type="text"],
.sw5e-helper-damage .extra-item input[type="text"] {
  flex: 1 1 260px;             /* grow nicely across the row */
  min-width: 200px;
}

/* Smart Weapon row: keep number inputs on the same line, fixed width */
.sw5e-helper-attack .row.smart input[type="number"] {
  width: 4.2rem !important;
  min-width: 4.2rem !important;
  flex: 0 0 auto;
}

/* Favorites & Weapon selects get a little breathing room so they don't force wraps */
.sw5e-helper-attack .row.favorites select,
.sw5e-helper-damage .row.favorites select { min-width: 180px; }
.sw5e-helper-attack .row.weapon select,
.sw5e-helper-damage .row.weapon select { min-width: 260px; }

/* Roll buttons look like one group but stay inline */
.sw5e-helper-attack .row.rollmode .seg-btn,
.sw5e-helper-damage .row.rollmode .seg-btn {
  flex: 0 0 auto;
  min-width: 110px;
}

/* styles/sw5e-helper.css additions (optional) */
/* compact header */
.sw5e-helper-card .weapon-banner{display:flex;align-items:center;gap:.5rem;margin-bottom:.25rem}
.sw5e-helper-card .weapon-title{display:flex;align-items:center;gap:.25rem;flex:1}
.sw5e-helper-card .weapon-icon{width:24px;height:24px;border-radius:.25rem;object-fit:cover}
.sw5e-helper-card .hdr-icons{display:flex;gap:.25rem}

.sw5e-helper-card details.target-row summary{display:flex;align-items:center;gap:.5rem}
.sw5e-helper-card .summary-right{margin-left:auto;display:flex;align-items:center;gap:.25rem}
.sw5e-helper-card .icons{display:inline-flex;gap:.25rem}
.sw5e-helper-card .icon-btn{cursor:pointer;text-decoration:none}
.sw5e-helper-card .mini-btn{padding:0 .25rem;cursor:pointer;text-decoration:underline;font-size:.9em}
.sw5e-helper-card .portrait{width:20px;height:20px;border-radius:50%;object-fit:cover}
.sw5e-helper-card .badge{margin-left:.25rem;padding:0 .25rem;border-radius:.25rem;font-size:.85em}
.sw5e-helper-card .damage-line{display:flex;align-items:center;gap:.4rem}
.sw5e-helper-card .applied-pill{margin-left:.4rem}
.sw5e-helper-card .icons{display:inline-flex;gap:.25rem}
.sw5e-helper-card .icon-btn{cursor:pointer;text-decoration:none}

.sw5e-helper-card .weapon-banner { display:flex; align-items:center; gap:.5rem; }
.sw5e-helper-card .weapon-banner .weapon-icon { width:28px; height:28px; border-radius:4px; }
.sw5e-helper-card .weapon-title { display:flex; align-items:center; gap:.4rem; flex:1; min-width:0; }
.sw5e-helper-card .weapon-title .name { flex:1; min-width:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.sw5e-helper-card .card-damage-controls { display:flex; align-items:center; gap:.5rem; margin:.35rem 0; }
.sw5e-helper-card .gm-toolbar { display:flex; align-items:center; gap:.35rem; margin-left:.35rem; }
.sw5e-helper-card .target-row summary { display:flex; align-items:center; gap:.5rem; }
.sw5e-helper-card .portrait { width:22px; height:22px; border-radius:3px; }
.sw5e-helper-card .tname { flex:1 1 auto; }
.sw5e-helper-card .attack-total { min-width:56px; text-align:right; }
.sw5e-helper-card .row-actions { display:flex; align-items:center; gap:.35rem; margin-left:.35rem; }
.sw5e-helper-card .icon-btn, .sw5e-helper-card .mini-btn { line-height:1; }
.sw5e-helper-card .status-badge { padding:0 .4rem; border-radius:8px; font-size:11px; }
.sw5e-helper-card .status-hit { background:#23384a; color:#dfefff; }
.sw5e-helper-card .status-miss { background:#4a2f23; color:#ffeedd; }
.sw5e-helper-card .status-crit { background:#244a2f; color:#eaffea; }
.sw5e-helper-card .status-fumble { background:#4a2424; color:#ffeeee; }
.sw5e-helper-card .status-saveonly { background:#333; color:#eee; }
.sw5e-helper-card .status-manual-damage { background:#4a4023; color:#ffffdd; }
.sw5e-helper-card .save-line.save-required { opacity:.85; font-style:italic; }
.sw5e-helper-card .applied-tag { margin-left:.4rem; opacity:.9; }
.sw5e-helper-card .missing { opacity:.6; }

/* Target separator line */
.sw5e-helper-card .target-separator { margin:.5rem 0; border:0; border-top:1px solid #ccc; }

/* Alternating target row backgrounds */
.sw5e-helper-card .target-row.even { background-color: rgba(255,255,255,0.05); }
.sw5e-helper-card .target-row.odd { background-color: rgba(0,0,0,0.05); }

/* Lines between target rows */
.sw5e-helper-card .target-row + .target-row { border-top: 1px solid rgba(255,255,255,0.1); }

/* Expand/collapse arrow */
.sw5e-helper-card .expand-arrow { 
  display: inline-block; 
  transition: transform 0.2s ease; 
  margin-right: 0.5rem; 
  font-size: 0.8em; 
  cursor: pointer; 
}
.sw5e-helper-card details[open] .expand-arrow { 
  transform: rotate(90deg); 
}

/* FIXED: Prevent dialog collapse when adding/removing rows */
.sw5e-helper-damage details.extras {
  margin: 0.5rem 0;
}

.sw5e-helper-damage .extra-row {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin: 0.25rem 0;
  padding: 0.25rem;
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 4px;
}

.sw5e-helper-damage .extra-row input[type="text"] {
  flex: 1 1 200px;
  min-width: 150px;
}

.sw5e-helper-damage .extra-row select {
  flex: 0 0 auto;
  min-width: 100px;
}

.sw5e-helper-damage .extra-row .chk {
  flex: 0 0 auto;
  white-space: nowrap;
}